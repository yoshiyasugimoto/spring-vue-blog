import{d as Q,k as W,l as x,f as C,t as P,c as o,b as s,e as X,j as k,q as Y,n as Z,r,u as z,o as p,h,g as c,s as B,v as D,a as F,p as w}from"./iframe-C3jG6tCW.js";import{f as ee,d as te,t as ae,p as oe,w as se}from"./decorators-Blxr28FJ.js";import{M as le}from"./MarkdownEditor-D9fLFh96.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./preload-helper-Dp1pzeXC.js";import"./data-BUIPDpdg.js";import"./github-BBxwyA0K.js";const ne={class:"page-header"},de={class:"page-title"},H=Q({__name:"PostEditView",setup(E){const m=z(),g=X(),V=ee(),v=k(!1),A=k([]),R=k([]),b=Y(()=>!!g.params.id),t=Z({title:"",slug:"",content:"",excerpt:"",coverImage:"",status:"DRAFT",categoryId:null,tagIds:[]});W(async()=>{var d,_;const[f,e]=await Promise.all([te.getAll(),ae.getAll()]);if(A.value=f.data,R.value=e.data,b.value){const i=Number(g.params.id),l=(await oe.getAll(0,1e3)).data.content.find(n=>n.id===i);l&&(t.title=l.title,t.slug=l.slug,t.content=l.content||"",t.excerpt=l.excerpt||"",t.coverImage=l.coverImage||"",t.status=l.status,t.categoryId=((d=l.category)==null?void 0:d.id)||null,t.tagIds=((_=l.tags)==null?void 0:_.map(n=>n.id))||[])}});async function U(f){if(!t.title.trim()){w.warning("タイトルを入力してください");return}v.value=!0;try{const e={title:t.title,slug:t.slug||void 0,content:t.content,excerpt:t.excerpt||void 0,coverImage:t.coverImage||void 0,status:f,categoryId:t.categoryId,tagIds:t.tagIds};b.value?(await V.updatePost(Number(g.params.id),e),w.success("記事を更新しました")):(await V.createPost(e),w.success("記事を作成しました"),m.push("/admin/posts"))}catch{w.error("保存に失敗しました")}finally{v.value=!1}}return(f,e)=>{const d=r("a-button"),_=r("a-space"),i=r("a-input"),u=r("a-card"),l=r("a-col"),n=r("a-form-item"),G=r("a-textarea"),J=r("a-form"),N=r("a-select-option"),S=r("a-select"),K=r("a-row");return p(),x("div",null,[C("div",ne,[C("h2",de,P(b.value?"記事を編集":"新規記事"),1),o(_,null,{default:s(()=>[o(d,{onClick:e[0]||(e[0]=a=>h(m).back())},{default:s(()=>[...e[10]||(e[10]=[c("戻る",-1)])]),_:1}),o(d,{onClick:e[1]||(e[1]=a=>U("DRAFT")),loading:v.value},{default:s(()=>[...e[11]||(e[11]=[c("下書き保存",-1)])]),_:1},8,["loading"]),o(d,{type:"primary",onClick:e[2]||(e[2]=a=>U("PUBLISHED")),loading:v.value},{default:s(()=>[...e[12]||(e[12]=[c("公開",-1)])]),_:1},8,["loading"])]),_:1})]),o(K,{gutter:24},{default:s(()=>[o(l,{span:18},{default:s(()=>[o(u,{bordered:!1,style:{"margin-bottom":"24px"}},{default:s(()=>[o(i,{value:t.title,"onUpdate:value":e[3]||(e[3]=a=>t.title=a),placeholder:"タイトルを入力...",size:"large",bordered:!1,class:"title-input"},null,8,["value"])]),_:1}),o(u,{bordered:!1},{default:s(()=>[o(le,{modelValue:t.content,"onUpdate:modelValue":e[4]||(e[4]=a=>t.content=a)},null,8,["modelValue"])]),_:1})]),_:1}),o(l,{span:6},{default:s(()=>[o(u,{title:"設定",bordered:!1,style:{"margin-bottom":"16px"}},{default:s(()=>[o(J,{layout:"vertical"},{default:s(()=>[o(n,{label:"スラッグ"},{default:s(()=>[o(i,{value:t.slug,"onUpdate:value":e[5]||(e[5]=a=>t.slug=a),placeholder:"url-slug"},null,8,["value"])]),_:1}),o(n,{label:"抜粋"},{default:s(()=>[o(G,{value:t.excerpt,"onUpdate:value":e[6]||(e[6]=a=>t.excerpt=a),rows:3,placeholder:"記事の要約..."},null,8,["value"])]),_:1}),o(n,{label:"カバー画像URL"},{default:s(()=>[o(i,{value:t.coverImage,"onUpdate:value":e[7]||(e[7]=a=>t.coverImage=a),placeholder:"https://..."},null,8,["value"])]),_:1})]),_:1})]),_:1}),o(u,{title:"カテゴリ",bordered:!1,style:{"margin-bottom":"16px"}},{default:s(()=>[o(S,{value:t.categoryId,"onUpdate:value":e[8]||(e[8]=a=>t.categoryId=a),placeholder:"カテゴリを選択","allow-clear":"",style:{width:"100%"}},{default:s(()=>[(p(!0),x(B,null,D(A.value,a=>(p(),F(N,{key:a.id,value:a.id},{default:s(()=>[c(P(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(u,{title:"タグ",bordered:!1},{default:s(()=>[o(S,{value:t.tagIds,"onUpdate:value":e[9]||(e[9]=a=>t.tagIds=a),mode:"multiple",placeholder:"タグを選択",style:{width:"100%"}},{default:s(()=>[(p(!0),x(B,null,D(R.value,a=>(p(),F(N,{key:a.id,value:a.id},{default:s(()=>[c(P(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})])}}}),ue=re(H,[["__scopeId","data-v-5a09af5d"]]);H.__docgenInfo={exportName:"default",displayName:"PostEditView",description:"",tags:{},sourceFiles:["/Users/sugimotoyoshiwataru/ai-driven-repository/spring-vue-blog/frontend/src/views/admin/PostEditView.vue"]};function O(E){return m=>(z().push(E),m())}const _e={title:"Views/Admin/PostEdit",component:ue,tags:["autodocs"],decorators:[se()]},y={decorators:[O("/admin/posts/new")]},I={decorators:[O("/admin/posts/1")]};var M,L,T;y.parameters={...y.parameters,docs:{...(M=y.parameters)==null?void 0:M.docs,source:{originalSource:`{
  decorators: [withRoute('/admin/posts/new')]
}`,...(T=(L=y.parameters)==null?void 0:L.docs)==null?void 0:T.source}}};var $,j,q;I.parameters={...I.parameters,docs:{...($=I.parameters)==null?void 0:$.docs,source:{originalSource:`{
  decorators: [withRoute('/admin/posts/1')]
}`,...(q=(j=I.parameters)==null?void 0:j.docs)==null?void 0:q.source}}};const we=["NewPost","EditPost"];export{I as EditPost,y as NewPost,we as __namedExportsOrder,_e as default};
